var Checkpoint;initCheckpoint();function initCheckpoint(){if("undefined"==typeof Checkpoint||null===Checkpoint)Checkpoint=new checkpoint_lib;return"undefined"==typeof Checkpoint||null===Checkpoint?!1:!0}function doCheckpoint(){return g_enable_checkpoint&&"undefined"!=typeof g_isdebug&&g_isdebug?(initCheckpoint(),Checkpoint.assert.apply(this,arguments)):!0}
function checkpoint_lib(){function c(a,b){return sprintf("%sproperty '%s' is missing or wrong type",b?"["+b+"] ":"",a)}function k(a,b){return sprintf("%sunexpected value of %s was found",b?"["+b+"] ":"",a)}function l(a,b){b=chomp(b);a===n?console.warn(b):a===m?console.error(b):console.log(b);return!0}var d=this,h=0,f=0,g=0,j=(new Date).getTime(),m=2,n=1;this.checkpoint=function(){return!0};this.init=function(){g=f=h=0;j=(new Date).getTime()};this.reset=function(){d.init()};this.assert=function(){var a=
arguments;if("undefined"==typeof g_isdebug||!g_isdebug)return g++,!0;var b=null;"undefined"!=typeof a[3]&&"function"==typeof a[3]&&(b=a[3],"undefined"!=typeof a[4]?b(a[4]):b());if(0>=a.length)return f++,b(),!1;if("undefined"!=typeof a[2]&&a[2])return g++,!0;if(!0===a[0])return h++,!0;f++;l(m,sprintf("ASSERT FAILED: %s !== true%s",a[0],a[1]?" : "+a[1]:""))};this.stats=function(){var a;a="undefined"!=typeof(new Date(j)).toUTCString?(new Date(j)).toUTCString():parseInt(j/1E3).toString();return l(0,sprintf("Since %s, %d good, %d bad, %d skipped\n",
a,h,f,g))};this.getstats=function(){return{good:h,bad:f,skipped:g}};this.validate_share_type=function(a,b){if(!a)return!1;var e;e=(e=(e=(e=(e=(e=(e=d.assert("string"==typeof a.id,c("id",b)))&&d.assert("string"==typeof a.sharekey,c("sharekey",b)))&&d.assert("string"==typeof a.sharename,c("sharename",b)))&&d.assert(d.in_array(a.readonly,["0","1"]),c("readonly",b)))&&d.assert(d.in_array(a.give,["0","1"]),c("give",b)))&&d.assert("string"==typeof a.sharekeyaes||""===a.sharekeyaes,c("sharekeyaes",b)))&&
d.assert(d.in_array(a.associative,[0,"0","1"]),c("associative",b));"undefined"!=typeof a.linkedshare&&(e=e&&d.assert(d.in_array(a.linkedshare,["0","1"]),c("linkedshare",b)));return e=(e=(e=(e=e&&d.assert("string"==typeof a.key,c("key",b)))&&d.assert("string"==typeof a.decsharename,c("decsharename",b)))&&d.assert(lpdec(a.sharename,a.key)===a.decsharename,k("sharename/decsharename",b)))&&d.assert(AES.hex2bin(lpmdec(a.sharekeyaes,!0))===a.key,k("decrypted sharing key",b))};this.validate_shareinfo_type=
function(a,b){if(!a)return!1;var e;return e=(e=(e=(e=(e=(e=(e=d.assert("string"==typeof a.id,c("id",b)))&&d.assert("string"==typeof a.sharekey,c("sharekey",b)))&&d.assert("string"==typeof a.decsharename,c("decsharename",b)))&&d.assert(d.in_array(a.readonly,["0","1"]),c("readonly",b)))&&d.assert(d.in_array(a.give,["0","1"]),c("give",b)))&&d.assert(d.in_array(a.associative,[0,"0","1"]),c("associative",b)))&&d.assert(d.in_array(a.linkedshare,["0","1"]),c("linkedshare",b))};this.in_array=function(a,b){if("undefined"==
typeof b||null===b)return!1;for(var d=b.length,c=0;c<=d;c++)if("undefined"!=typeof b[c]&&b[c]===a)return lpArrayOffset=c,!0;return!1}}function chomp(c){if(!c||"string"!=typeof c)return null;"\n"==c.substr(c.length-1,1)&&(c=c.substr(0,c.length-1));return c};
