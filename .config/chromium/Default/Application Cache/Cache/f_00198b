function jFc(a,b,c){b=ub(a,b.equals,b);0<=b&&b!=c&&(b=Ab(a,b,1),Ab(a,c,0,b[0]))}function kFc(a){var b=ritz.convertPivotTableDefToRitz(GCa.Qb(MCa(a))),b=GCa.ld((new Gj).ya(),b);if(null!=a.F){var c;c=fg(b,6);c=fg(c,1);I(c,6,""+a.F)}return b}function lFc(a,b,c){function d(a){if(a.Br()){var b=Math.min(e,c),d=Math.max(e,c);a=a.nr();var l=a.gr();l==e?a.fn(c):l>=b&&l<=d&&(e>c?a.fn(l+1):e<c&&a.fn(l-1))}}var e=lb(a.C,b);jFc(a.C,b,c);B(a.B,d);B(a.o,d)}
function mFc(a,b){var c=ub(a.C,b.equals,b);if(0<=c){Db(a.C,c);var d=function(a){if(a.Br()){var b=a.nr(),d=b.gr();d==c?a.iB():d>c&&b.fn(d-1)}};B(a.B,d);B(a.o,d)}}function nFc(a,b,c){null!=c?(zb(a.C,b,c),b=function(a){if(a.Br()){a=a.nr();var b=a.gr();b>=c&&a.fn(b+1)}},B(a.B,b),B(a.o,b)):a.C.push(b)}
function oFc(a,b){var c=new ig;I(c,3,a);var d=b.dd,e=b.isRow(),f=new jg;if(!e){var h=new kg,k=b.Rb();I(h,1,k);I(f,2,h)}d||(h=new kg,k=b.Fb(),I(h,1,k),f.CD(h));I(c,2,f);f=new jg;e||(e=new kg,h=b.jb()+1,I(e,1,h),I(f,2,e));d||(d=new kg,e=b.mb()+1,I(d,1,e),f.CD(d));I(c,1,f);return c}function pFc(a,b){I(a,2,b)}function qFc(a,b){I(a,3,b)}function rFc(a,b){I(a,8,b)}function sFc(a){return fg(a,8)}function tFc(a,b){I(a,3,b)}
function uFc(a,b,c){var d=b.mb();b=b.jb();a=a?a.Bc(d,b+c).getDisplayValue():"";""==a&&(a="Column "+Jt(b+c));return a};function r$(a,b){vG.call(this,1602,b);this.o=a}A(r$,vG);r$.prototype.Nc=function(){return r$.K.Nc.call(this)};r$.prototype.sd=p(47);r$.prototype.kd=function(){var a=new Us,b=kFc(this.o);I(a,1,b);return a};function s$(a,b){M.call(this,a,b)}A(s$,M);function vFc(a){a=a||{};a=""+tv(EY(ov(a,{title:pv("Report Editor"),Pe:qv('<div id="waffle-pivot-pane"><div id="waffle-pivot-range-selection"><div class="input-selection-button goog-inline-block"></div><span class="waffle-pivot-label-text waffle-pivot-range-span" id="waffle-pivot-range-text"></span><span class="waffle-pivot-label-text waffle-pivot-range-span">&nbsp;-&nbsp;</span>'+tv(Av({Zc:"goog-inline-block waffle-pivot-label-button",content:qv("Edit range..."),id:"waffle-pivot-range-selection-button",
style:4}))+'</div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+wFc({Gm:pv("Rows"),id:"waffle-pivot-add-field-row"})+'</div><div id="waffle-pivot-row-label" class="waffle-pivot-drop-target"></div></div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+wFc({Gm:pv("Columns"),id:"waffle-pivot-add-field-column"})+'</div><div id="waffle-pivot-column-label" class="waffle-pivot-drop-target"></div></div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+
wFc({Gm:pv("Values"),id:"waffle-pivot-add-field-value"})+'<div id="waffle-pivot-aggr"><span id="waffle-pivot-aggr-label" class="waffle-pivot-label-text">as:&nbsp;</span><div id="waffle-pivot-aggr-select"></div></div></div><div id="waffle-pivot-values" class="waffle-pivot-drop-target"></div></div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+wFc({Gm:pv("Filter"),id:"waffle-pivot-add-field-filter"})+'</div><div id="waffle-pivot-filter" class="waffle-pivot-drop-target"></div></div><div id="waffle-pivot-button-container"><label><input type="radio" name="autoupdate" value="autoupdate" checked id="waffle-pivot-update-auto" />Update table on each change</label><br /><label><input type="radio" name="autoupdate" value="manual" id="waffle-pivot-update-manual"/>Manually</label><button id="waffle-pivot-button-update" disabled="true">Update table</button><br /></div></div>')})));
return gv(a)}function wFc(a){var b;b=""+('<strong id="'+Y(a.id)+'-field-label">'+X(a.Gm)+'</strong><span class="waffle-pivot-label-text">&nbsp;-&nbsp;</span>');var c;c=pv("Add field");b+=tv(Av({Zc:"goog-inline-block waffle-pivot-label-button",content:c,attributes:rv('aria-label="'+Y(a.Gm)+" "+Y(c)+'"'),id:a.id,style:4}));return gv(b)}
function xFc(a){return gv('<div class="waffle-pivot-pill" role="group" tabindex="0"><table class="waffle-pivot-pill-main-table" role="presentation"><tbody><tr><td class="waffle-pivot-pill-main-table-text"><strong>'+X(a.cT)+'&nbsp;</strong><span class="waffle-pivot-pill-title"></span></td><td class="waffle-pivot-pill-main-table-fill"><div class="waffle-pivot-pill-draghandle"></div></td><td class="waffle-pivot-pill-close waffle-pivot-pill-nodrag"></td></tr></tbody></table></div>')};function t$(a,b,c,d,e){R.call(this,e);this.J=a;this.M=c;this.L=d;this.pe(b)}A(t$,R);r=t$.prototype;r.Ta=function(){this.Ba=Du(xFc,{cT:this.J})};r.La=function(){t$.K.La.call(this);var a=this.la(),b=S(this);this.D=$h(a,"span","waffle-pivot-pill-title",this.getElement())[0];var c=new TA("\u2715",a,4);c.render($h(a,"td","waffle-pivot-pill-close",this.getElement())[0]);ln(c.getElement(),"Close edit field and remove from pivot table");K(this,c);b.H(c,"action",this.Jhb)};
r.WD=function(){var a=new s$("pivot-pill-changed",this);a.j=this;this.dispatchEvent(a)};function yFc(a,b){a.la().Bf(a.D,b);ln(a.getElement(),"Edit field: "+(a.J+(" "+(b+"."))));a.D.title=b}function zFc(a){return a.la().nC(a.D)}function u$(a,b){return uFc(a.M,a.L,b)}function AFc(a,b,c){a=a.la();return a.Aa("span",c,a.createTextNode(b+"\u00a0"))}function v$(a){return a.la().Aa("div","waffle-pivot-pill-nodrag")}
r.gQ=function(a){var b=this.la(),c=b.Aa("div","waffle-pivot-pill-section",arguments);1<Jh(this.getElement()).length&&on(c,"waffle-pivot-pill-section-top-border");b.appendChild(this.getElement(),c)};r.Hw=function(a){S(this).H(a.getElement(),"mouseover",this.VY).H(a.getElement(),"mouseout",this.VY)};r.VY=function(a){Ona(a.target,"waffle-pivot-select-hover")};r.Yl=g("L");r.Hb=g("M");r.Jhb=function(){var a=new s$("pivot-remove-pill",this);a.j=this;this.dispatchEvent(a)};function w$(){}A(w$,sE);ja(w$);w$.prototype.Nb=p("waffle-pivot-select");w$.prototype.pB=function(a){return a.Aa("div","goog-inline-block "+(this.Nb()+"-dropdown"),"\u00a0\u25be")};function x$(a,b,c,d){t$.call(this,"Filter:",a,b,c,d);this.j=new EE("",null,w$.getInstance(),d);K(this,this.j)}A(x$,t$);x$.prototype.La=function(){x$.K.La.call(this);var a=this.getModel();yFc(this,u$(this,a.Zf()));var a=AFc(this,"Show:"),b=v$(this);this.j.Ua(b);this.j.Er=!0;this.j.Hv("Loading...");ln(this.j.Ba,"Show:");var c=new y$;K(this,c);this.j.Ge(c);this.Hw(this.j);this.gQ(a,b)};function z$(a){return a.j.Eb().j}
x$.prototype.Hw=function(a){x$.K.Hw.call(this,a);S(this).H(z$(this),"filters_selected",this.o).H(z$(this),"filtering_cancelled",this.B)};function BFc(a,b,c){var d=[];if(!c)return d;a=b.jb()+a;var e=Rf(b,"r");for(b=b.mb()+1;b<e.end;b++){var f=c.Bc(b,a);Rb(d,f.getDisplayValue(),APb)}return d}function CFc(a){var b=z$(a),c=a.getModel().B(),d=new qd(c),e=pb(u0(b),function(a,b){return d.contains(b)?a-1:a},u0(b).length);xPb(b,c);DFc(a,e)}
function DFc(a,b){var c=z$(a);0==b?a.j.Hv(wXb()):(c=u0(c).length-b,a.j.Hv(wXb(c)))}x$.prototype.o=function(a){this.j.ud(!1);DFc(this,a.ba.length);this.WD()};x$.prototype.B=function(){this.j.ud(!1);var a=this.j.Ba;try{yd&&this.la().ib().body.focus(),a.focus()}catch(b){}CFc(this)};function y$(a){pE.call(this,a);this.j=new RY([],!1,null,a)}A(y$,pE);y$.prototype.La=function(){y$.K.La.call(this);this.j.render(this.rb());var a=new HA(this.j.Ba,this.la());IA(a);K(this,a)};
y$.prototype.uC=function(a){Mh(a.target)&&this.j.oj(a.target)||y$.K.uC.call(this,a)};function A$(a,b,c,d,e){t$.call(this,"Group by:",a,b,c,e);this.O=d}A(A$,t$);r=A$.prototype;
r.La=function(){A$.K.La.call(this);var a=this.getModel();yFc(this,u$(this,a.Zf()));var b=this.la(),a=AFc(this,"Order:"),c=v$(this),d=new pE;d.Oa(new kE(b.Pg("Ascending"),1),!0);d.Oa(new kE(b.Pg("Descending"),2),!0);b=this.F=new EE("",d,w$.getInstance(),b);b.Ua(c);b.Ra(sFc(this.getModel()));ln(b.getElement(),"Order:");this.Hw(b);this.gQ(a,c);var b=this.la(),c=AFc(this,"Sort by:"),a=v$(this),d=new pE,e=u$(this,this.getModel().Zf());d.Oa(new kE(e,-1),!0);d=this.B=new EE("",d,w$.getInstance(),b);d.Ua(a);
ln(d.getElement(),"Sort by:");S(this).H(d.getElement(),"mouseover",this.VY).H(d.getElement(),"mouseout",this.VY).H(d,"action",this.Nhb);b=z(b.Aa,b,"div",["goog-inline-block","waffle-pivot-pill-sort-by"]);c=b(c);this.G=b(a);this.gQ(c,this.G);a=this.getModel();a=fg(a,3);c=AFc(this,"Show totals","waffle-pivot-pill-align-middle waffle-pivot-pill-nodrag");b=v$(this);on(b,"goog-inline-block");this.o=new cK;aK(this.o,c);this.o.Xb(a);this.o.render(b);S(this).H(this.o,"change",this.WD);this.gQ(b,c)};
r.isRow=g("O");r.Nhb=function(a){a=new s$("pivot-sort-by-change",a.currentTarget);a.j=this;this.dispatchEvent(a)};r.Ohb=function(a){a=new s$("pivot-sort-key-change",a.currentTarget);a.j=this;this.dispatchEvent(a)};function EFc(a){var b=[];if(a.j)for(var c=a.j.Wb(),d=0;d<c;d++)0<=a.j.$b(d).getValue()&&b.push(a.j.$b(d).Li());return b}function FFc(a){if(!a.j){var b=a.la(),c=v$(a);on(c,"waffle-pivot-multi-select");a.j=new bE("horizontal",null,b);a.j.Ua(c);b.appendChild(a.G,c)}}
r.Hw=function(a){A$.K.Hw.call(this,a);S(this).H(a,"hide",this.WD)};r.R=function(){A$.K.R.call(this);L(this.F);L(this.B);L(this.j);L(this.o);this.G=null};function B$(a,b,c,d){t$.call(this,"Display:",a,b,c,d)}A(B$,t$);var GFc="SUM COUNTA COUNT COUNTUNIQUE AVERAGE MAX MIN MEDIAN PRODUCT STDEV STDEVP VAR VARP".split(" ");B$.prototype.La=function(){B$.K.La.call(this);var a=this.getModel();yFc(this,u$(this,a.Zf()));HFc(this)};
function HFc(a){var b=a.la(),c=AFc(a,"Summarize by:"),d=v$(a),e=new pE;B(GFc,function(a){e.Oa(new kE(a),!0)});b=a.j=new EE("",e,w$.getInstance(),b);b.Ua(d);b.Ra(a.getModel().$s());ln(b.getElement(),"Summarize by:");a.Hw(b);a.gQ(c,d)}B$.prototype.getValue=function(){return this.j.getValue()};B$.prototype.Hw=function(a){B$.K.Hw.call(this,a);S(this).H(a,"hide",this.WD)};B$.prototype.R=function(){B$.K.R.call(this);L(this.j)};function C$(a,b,c,d,e){FY.call(this,e);this.F=null;this.Za=b;this.gb=c;this.Sa=d;this.o={};this.D=!0;this.Pa=new IFc;this.ba=new P(this);this.xa=new ZY;this.O=[];this.L=this.B=null;this.eb=new kE("No fields left to add",void 0,e);this.eb.Ia(!1)}A(C$,FY);
var D$={Nu:"waffle-pivot-values",qs:"waffle-pivot-filter",d_:"waffle-pivot-column-label",w0:"waffle-pivot-row-label",KZ:"waffle-pivot-add-field-value",IZ:"waffle-pivot-add-field-filter",JZ:"waffle-pivot-add-field-row",HZ:"waffle-pivot-add-field-column",LZ:"waffle-pivot-aggr-select",MZ:"waffle-pivot-aggr",IAa:"waffle-pivot-apply",$Z:"waffle-pivot-button-container",FEa:"waffle-pivot-range-selection",GEa:"waffle-pivot-range-selection-button",HEa:"waffle-pivot-range-text",IK:"waffle-pivot-button-update",
R0:"waffle-pivot-update-auto",S0:"waffle-pivot-update-manual"},E$={EK:"row-breakout",SJ:"col-breakout",qs:"filter",Nu:"aggregation"};r=C$.prototype;r.Ta=function(){var a=this.la();this.Ba=Du(vFc,{id:this.getId()});var b=new pE(a);b.Oa(new kE("Columns",2,a),!0);b.Oa(new kE("Rows",1,a),!0);this.G=new EE("",b,w$.getInstance(),a)};
r.La=function(){function a(a,b){e.H(ph(a),"click",b)}C$.K.La.call(this);var b=this.la();O(b.getElement(D$.$Z),!1);this.J=pc(E$.Nu,b.getElement(D$.Nu),E$.qs,b.getElement(D$.qs),E$.EK,b.getElement(D$.w0),E$.SJ,b.getElement(D$.d_));this.Ea=pc(D$.KZ,E$.Nu,D$.IZ,E$.qs,D$.JZ,E$.EK,D$.HZ,E$.SJ);this.zb=b.getElement(D$.IK);var c=Yy(AE,""),d=sXb(),e=S(this),f;for(f in this.Ea){var h=new tE("",new pE(b,d),c,b);K(this,h);h.Ua(b.getElement(f));e.H(h,"show",this.$kb).H(h.Eb(),"action",this.Zkb)}a(D$.IK,this.jlb);
a(D$.R0,this.Iya);a(D$.S0,this.Iya);this.M=b.getElement(D$.MZ);O(this.M,!1);this.G.Ua(b.getElement(D$.LZ));e.H(this.G,"action",this.alb);this.L||(this.L=new Cn(this.rb()));e.H(this.L,"focusin",this.elb).H(this.L,"focusout",this.flb);JFc(this)};r.elb=function(a){this.B=KFc(this,a.target)};r.flb=function(a){if(a=a.relatedTarget){var b=this.rb();Xh(a,function(a){return a==b})||(this.B=null)}};
function KFc(a,b){if(!b)return null;var c=a.la().Oka(b,"waffle-pivot-pill");if(!c)return null;var d=null,e=null;Xb(a.o,function(a,b){return(d=tb(a,function(a){return a.getElement()==c}))?(e=b,!0):!1});return d?{container:e,label:zFc(d)}:null}
function LFc(a){var b=a.la();if(a.B){var c=a.B.container,d=a.o[c];if(d&&a.B.label)for(var e=0,f;f=d[e];e++)if(zFc(f)==a.B.label){MFc(a,f.getElement());return}d&&0<d.length?MFc(a,d[d.length-1].getElement()):(d=dc(a.Ea,function(a){return a==c}),MFc(a,b.getElement(d)))}}
r.pe=function(a){C$.K.pe.call(this,a);NFc(this,function(){function b(a,b){var c="row-breakout"==a,c=new A$(b,F$(this),G$(this),c,this.la());c.render();OFc(this,c,a)}this.reset();B(a.Zs(),function(a){a=new x$(a,F$(this),G$(this),this.la());a.render();OFc(this,a,"filter")},this);B(a.Nn(),ya(b,"row-breakout"),this);B(a.Hn(),ya(b,"col-breakout"),this);B(a.Sp(),function(a){a=new B$(a,F$(this),G$(this),this.la());a.render();OFc(this,a,"aggregation")},this);var c;c=(c=(c=nw(this.Sa.j,a.Lm()))?c.j:null)?
Vt(a.Yl(F$(this)),c):"#REF!";PFc(this,c);this.Pa.Ra(c);(c=this.o.aggregation)&&2<=c.length?(O(this.M,!0),this.G.Ra(a.Go())):O(this.M,!1);LFc(this)});QFc(this,function(){var a=this.o.filter;a&&B(a,function(a){var b=z$(a),e;e=BFc(a.getModel().Zf(),a.Yl(),a.Hb());wPb(b,e);CFc(a)},this)})};r.focus=function(){C$.K.focus.call(this);MFc(this,rh("waffle-sidebar-title",this.getElement()))};function OFc(a,b,c){a.J[c].appendChild(b.getElement());a.o[c]||(a.o[c]=[]);a.o[c].push(b);b.rc(a);RFc(a,b);JFc(a)}
function RFc(a,b){S(a).H(b,"pivot-remove-pill",a.ilb).H(b,"pivot-pill-changed",a.hlb).H(b.getElement(),"keydown",a.glb);var c=new s$("pivot-pill-created");c.j=b;a.dispatchEvent(c)}function JFc(a){a.ba.Ib();L(a.xa);var b=a.xa=new ZY;Ub(a.J,function(a){$Y(b,a)});b.Fd();a.ba.H(b,"beforedragstart",a.blb).H(b,"dragstart",a.dlb).H(b,"dragend",a.clb)}r.reset=function(){Ub(this.o,function(a){B(a,L)});this.o={}};function PFc(a,b){var c=a.la();c.Bf(c.getElement("waffle-pivot-range-text"),b)}
r.ilb=function(a){var b=new s$("pivot-pill-removed",this);b.j=a.target;b.container=dc(this.o,function(b){return vb(b,a.target)});b.container&&(Cb(this.o[b.container],a.target),this.B={container:b.container,label:null},this.dispatchEvent(b))};r.hlb=function(a){a.container=dc(this.o,function(b){return vb(b,a.target)})};r.glb=function(a){!a.shiftKey||38!=a.keyCode&&40!=a.keyCode||SFc(this,a.target,38==a.keyCode)};
function SFc(a,b,c){var d=null,e=-1;Xb(a.J,function(a,c){e=lb(a.childNodes,b);return 0<=e?(d=c,!0):!1});var f=a.o[d];if(!(!f||1>=f.length||(c=c?e-1:e+1,0>c||c>f.length-1))){yXb(f,e,c);var h=new s$("pivot-pill-changed",a);h.j=f[c];h.container=d;h.B=d;h.position=c;a.dispatchEvent(h)}}r.jlb=function(){this.dispatchEvent("pivot-table-update")};r.Iya=function(a){a=this.D="autoupdate"==a.target.value;(this.zb.disabled=a)&&this.dispatchEvent("pivot-table-update")};r.alb=function(){this.dispatchEvent("pivot-aggregation-orientation-changed")};
r.Go=function(){return this.G.getValue()};function TFc(a,b,c,d){var e=a.Pa;Zg(a.F);gPb(a.Za,e,e.getValue(),!1,!1,!0,z(a.klb,a,b,c,!!d))}r.klb=function(a,b,c,d){var e=this.Pa,f=this.Sa;e.j=!1;var h=e.getValue();this.F=Xg(d,"afterhide",function(){if(e.j){var d=St(e.getValue(),f.j,!0,!0);d?a(d):(e.Ra(h),b())}else b();c||MFc(this,ph("waffle-pivot-range-selection-button"))},!1,this)};
r.$kb=function(a){var b=a.target.getParent(),c=b.Eb();this.Wa=this.Ea[b.Ba.id];NFc(this,function(){var a=this.Wa,e=F$(this),f=G$(this),a=UFc(this,a);c.jd(!0);for(var h=Rf(f,"c"),k=0,l=h.start;l<h.end;l++){var m=uFc(e,f,k);m&&!a[m]&&c.Oa(new kE(m,k),!0);k++}0==c.Wb()&&c.Oa(this.eb,!0);KU(b,!0);b.Pt();KU(b,!1)})};function MFc(a,b){try{yd&&a.la().ib().body.focus(),b.focus(),a.gb.Tb(2)}catch(c){}}
r.Zkb=function(a){var b=this.Wa;a=a.target.getValue();var c=new s$("pivot-pill-added",this);c.container=b;c.D=a;this.B={container:b,label:null};this.dispatchEvent(c)};r.blb=function(a){for(var b=a.event.target||a.event.j.target;b instanceof Element&&!nn(b,"waffle-pivot-pill");b=b.parentNode)if(nn(b,"waffle-pivot-pill-nodrag")){a.preventDefault();break}};r.dlb=function(a){var b=bm(a.j).width;Nl(a.B,b)};
r.clb=function(a){var b,c,d,e,f=new s$("pivot-pill-changed",this);Xb(this.J,function(c,d){e=lb(c.childNodes,a.j);return 0<=e?(b=d,!0):!1});Xb(this.o,function(b,e){var l=tb(b,function(b){return b.getElement()==a.j});return l?(c=e,f.j=d=l,!0):!1});this.o[b]||(this.o[b]=[]);Cb(this.o[c],d);zb(this.o[b],d,e);f.container=b;f.B=c;f.position=e;this.dispatchEvent(f)};
function UFc(a,b){function c(a){a=f(a.Zf());e[a]=!0}var d=a.getModel(),e={},f=z(uFc,a,F$(a),G$(a));if(d)switch(b){case "filter":B(d.Zs(),c);break;case "row-breakout":case "col-breakout":B(d.Nn(),c),B(d.Hn(),c)}return e}function NFc(a,b){var c=VFc(a);if(c){var d=G$(a),d=new If(d.mb(),d.jb(),d.mb()+1,d.Rb());We?WFc(a,d,b):kr(c.B,d,z(b,a),S(a))}else b.call(a)}function QFc(a,b){var c=VFc(a);c?We?WFc(a,G$(a),b):kr(c.B,G$(a),z(b,a),S(a)):b.call(a)}
function WFc(a,b,c){b=ir(jw(VFc(a)),b).addCallback(c,a);a.O.push(b);Vm(b,ya(Cb,a.O,b))}function VFc(a){var b=a.getModel();return nw(a.Sa.j,b.Lm())}function F$(a){return(a=VFc(a))?a.Hb():null}function G$(a){return a.getModel().Yl(F$(a))}r.R=function(){C$.K.R.call(this);Ub(this.o,function(a){B(a,L)});this.o={};Zg(this.F);this.F=null;L(this.xa);L(this.ba);B(this.O,cy)};function IFc(){N.call(this);this.o="";this.j=!1}A(IFc,N);IFc.prototype.getValue=g("o");
IFc.prototype.Ra=function(a){this.o=a;this.j=!0;this.dispatchEvent("change")};function XFc(a,b){J.call(this);this.j=a;this.B=b;this.o=new P(this);K(this,this.o);this.o.H(a,"pivot-pill-created",this.C)}A(XFc,J);XFc.prototype.D=function(a){var b=a.j;-1==a.target.getValue()?(b.j&&(L(b.j),b.j=null),b.WD()):0<YFc(this,b).length&&!b.j?(FFc(b),b.j.getElement().focus(),ZFc(this,b,-2,!0)):b.WD()};
XFc.prototype.F=function(a){var b=a.j;a=a.target;var c=Nn(b.j,a),d=b.la();for(c++;c<b.j.Wb();){var e=b.j.$b(c),f=d.zU(e.getElement());nn(f,"waffle-pivot-select-divider")&&d.lf(f);b.j.removeChild(e,!0)}(0>a.getValue()||!ZFc(this,b,-2,!0))&&b.WD()};function $Fc(a,b){a.o.H(b,"pivot-sort-by-change",a.D).H(b,"pivot-sort-key-change",a.F)}
XFc.prototype.C=function(a){var b=a.j;if(b instanceof A$){var c=0<YFc(this,b).length;a=this.j.getModel().Sp();B(a,function(a,d){var h=a.getFunctionName(),k=u$(b,a.Zf());b.B.Gd(new kE(c?h+(" of "+(k+" in...")):h+(" of "+k),d))});a=b.getModel();if(a.Br()){var d=a.nr();a=d.GP();aGc(this,b,a)&&(d=d.gr(),b.B.Ra(d),c&&(FFc(b),B(a,z(function(a){ZFc(this,b,a,!1)},this)),ZFc(this,b,-1,!1)))}$Fc(this,b)}};
function ZFc(a,b,c,d){var e=bGc(a,b);if(0==e.length)return!1;var f=b.j.Wb();a=YFc(a,b);if(f>=a.length)return!1;var h=u$(b,a[f].Zf()),f=b.la();a=b.j.Wb();var k=new pE,l=new kE(h,-2);l.Ia(!1);k.Oa(l,!0);k.Oa(new kE(0==a?"Grand Total":"Total",-1),!0);for(l=0;l<e.length;l++)k.Oa(new kE(e[l],l),!0);h=new EE(h,k,w$.getInstance(),f);h.Ra(-2);b.j.Oa(h,!0);0<a&&(a=f.Aa("div",["goog-inline-block","waffle-pivot-select-divider"],":"),f.Dt(a,h.getElement()));S(b).H(h,"action",b.Ohb);f=c;"string"==typeof c&&(f=
lb(e,c),-1==f&&(f=-2));h.Ra(f);d&&(b.j.bf(h),h.ud(!0));return!0}function bGc(a,b){var c=cGc(a,b),d=EFc(b),e=d.length,f=[];B(c,function(a){a.length==e+1&&sb(d,function(b,c){return a[c]==b})&&Rb(f,a[e])});return f}function aGc(a,b,c){a=cGc(a,b);return 0==c.length||qb(a,function(a){return Qb(c,a)})}function YFc(a,b){return b.isRow()?a.j.getModel().Hn():a.j.getModel().Nn()}function cGc(a,b){return b.isRow()?HCa(a.j.getModel(),a.B):ICa(a.j.getModel(),a.B)};function H$(a,b){Yt.call(this,1601,b,Kf(ow(a,b)));this.o=a}A(H$,Yt);H$.prototype.exec=function(){var a=ow(this.o,this.getModel()),b=this.getModel();YDa(b.B,a.y,"r")&&(a=this.getModel().Ila(),b=this.o,(a.Qa=b)||a.Ea?qm(a,1024):a.j&=-1025)};H$.prototype.Nc=function(){return H$.K.Nc.call(this)};H$.prototype.sd=p(48);H$.prototype.kd=function(){var a=new Vs,b=kFc(this.o);I(a,2,b);var b=ow(this.o,this.getModel()),c=new ni;I(c,1,""+this.o.Zl());c.Sr(b.y);I(c,3,b.x);I(a,1,c);return a};function dGc(a,b,c,d,e){DY.call(this,a,c);this.B=this.G=null;this.j=a;this.o=b;this.M=d;this.J=e;this.O=new XFc(this.j,this.o);K(this,this.O);b=b.j;c=a.la();this.aa.H(a,"pivot-table-update",this.Ukb).H(a,"pivot-pill-added",this.Mkb).H(a,"pivot-pill-removed",this.Okb).H(a,"pivot-pill-changed",this.Nkb).H(a,"pivot-aggregation-orientation-changed",this.Lkb).H(Jo,"show-pivot",this.Tkb).H(e,"activeCellChange",this.Yba).H(e,"click",this.Vkb,!0).H(e,"pivot_table_zippy_toggle",this.Wkb).H(b,"a",this.Yba).H(b,
"d",this.Skb).H(c.getElement("waffle-pivot-range-selection-button"),"click",this.Pkb).H(c.getElement("waffle-pivot-range-selection-button"),"keypress",this.Qkb);a=["Ea"];a.push("P");this.aa.H(Zv(b),a,this.Yba)}A(dGc,DY);r=dGc.prototype;r.Pf=function(){return V.n0};r.Lo=function(){return V.m0};r.Pkb=function(){eGc(this)};r.Qkb=function(a){13==a.keyCode&&(a.preventDefault(),a.stopPropagation(),eGc(this))};function eGc(a){TFc(a.j,z(a.Rkb,a,fGc(a)),ia)}
r.Rkb=function(a,b){a.F=b.fc;var c=oFc(b.Tf,b.rect);a.G=c;I$(this,a,this.j.D);var c=a.Zl(),d=this.o.j;Ct(d)!=c&&gM(d,c)};r.Tkb=function(){if(!jea(Me.getInstance())){var a=this.j;if(!a.Va()){var b=this.o.j.getActiveGrid(),c=gGc(this);if(!c&&b){this.j.reset();var a=b.B,c=b.Hb(),d=qx(c),e=ox(c);d?(We?mr(a,e,ac(Jd)):or(a,e,ac(Jd),this.aa)).addCallback(z(this.Hya,this,b)):this.Hya(b,ix(c));return}this.B=c;a.pe(c)}this.Lo().fireAction()}};
r.Nkb=function(a){var b=a.container,c=a.B,d=a.j,e=a.j.getModel(),f=d;if(d&&c&&b!=c){f=hGc(d.getModel(),b);a:{var h=this.j;switch(b){case "row-breakout":case "col-breakout":var k="row-breakout"==b,f=new A$(f,F$(h),G$(h),k,h.la());break a;case "aggregation":f=new B$(f,F$(h),G$(h),h.la());break a;case "filter":f=new x$(f,F$(h),G$(h),h.la());break a;default:f=null}}f.render();h=this.j;k=f;h.la().zz(k.getElement(),d.getElement());var l=h.o[b],m=lb(l,d);Ab(l,m,1,k);L(d);k.rc(h);RFc(h,k);JFc(h)}d=fGc(this);
a=a.position;h=c==b;k=f.getModel().Zf();if(c)if(h){f=f.getModel();switch(b){case "row-breakout":jFc(d.B,f,a);break;case "col-breakout":jFc(d.o,f,a);break;case "filter":jFc(d.D,f,a);break;case "aggregation":lFc(d,f,a)}Mo(vXb(a))}else iGc(this,b,d,k,a);else jGc(b,f,d);c&&!h&&kGc(e,c,d);I$(this,d,this.j.D)};
function hGc(a,b){switch(b){case "row-breakout":case "col-breakout":if(a instanceof mg)return a;var c=new mg,d=a.Zf();I(c,9,d);return c;case "aggregation":if(a instanceof og)return a;c=new og;d=a.Zf();I(c,3,d);return c;case "filter":if(a instanceof hg)return a;c=new hg;d=a.Zf();I(c,6,d);return c;default:return null}}r.Mkb=function(a){var b=a.container,c=fGc(this);iGc(this,b,c,a.D,a.position);I$(this,c,this.j.D)};
r.Okb=function(a){var b=fGc(this);kGc(a.j.getModel(),a.container,b);L(a.j);I$(this,b,this.j.D)};r.Lkb=function(){var a=fGc(this),b=this.j.Go();a.J=b;I$(this,a,this.j.D)};
function iGc(a,b,c,d,e){switch(b){case "row-breakout":a=new mg;I(a,9,d);d=a;null!=e?zb(c.B,d,e):c.B.push(d);break;case "col-breakout":a=new mg;I(a,9,d);d=a;null!=e?zb(c.o,d,e):c.o.push(d);break;case "filter":a=nw(a.o.j,c.Lm()).Hb();a=BFc(d,c.Yl(a),a);b=new hg;I(b,6,d);lGc(b,a);null!=e?zb(c.D,b,e):c.D.push(b);break;case "aggregation":a=new og,I(a,3,d),pFc(a,"SUM"),nFc(c,a,e)}}
function kGc(a,b,c){switch(b){case "row-breakout":Naa(c.B,a.equals,a);break;case "col-breakout":Naa(c.o,a.equals,a);break;case "filter":Naa(c.D,a.equals,a);break;case "aggregation":mFc(c,a)}}
function jGc(a,b,c){if("aggregation"==a)a=tb(c.Sp(),function(a){return a.equals(b.getModel())}),null!=a&&pFc(a,b.getValue());else if("filter"==a)a=tb(c.Zs(),function(a){return a.equals(b.getModel())}),null!=a&&lGc(a,yPb(z$(b),!0));else if(a=tb("row-breakout"==a?c.Nn():c.Hn(),function(a){return a.equals(b.getModel())}),null!=a)if(tFc(a,b.o.Dc()),rFc(a,b.F.getValue()),-1!=b.B.getValue()){var d=new ng;d.fn(b.B.getValue());B(EFc(b),function(a){bg(d,2,a)});qFc(d,b.F.getValue());I(a,10,d)}else a.iB()}
r.Ukb=function(){I$(this,gGc(this),!0)};function I$(a,b,c){b&&(c?(c=st(a.o.j,b.Zl()),c=new H$(b,c),a.M.Mb(c),a.G=null):a.G=b,a.j.pe(b))}r.Hya=function(a,b){var c=a.Hb(),d=qx(c),c=ox(c);d&&b.equals(c)?TFc(this.j,z(this.Gya,this),z(this.Xkb,this),!0):this.Gya(new ep(a.$a(),a.j,b))};r.Xkb=function(){this.Pf().setVisible(!1);this.F.Tb(3)};
r.Gya=function(a){var b;b=new pg;var c=new ig,d=new jg,e=new kg,f=new kg;I(e,1,1);I(f,1,1);d.CD(e);I(d,2,f);var e=new jg,f=new kg,h=new kg;I(f,1,1);I(h,1,1);e.CD(f);I(e,2,h);I(c,1,d);I(c,2,e);I(b,6,c);I(b,5,2);b=LCa(b,0,new C(0,0),0);b.F=a.fc;a=oFc(a.Tf,a.rect);b.G=a;a=Ct(this.o.j);this.M.Mb(new r$(b,a))};function gGc(a){if(a.G)return a.G;(a=a.o.j.j)&&0==a.getSheetType()?(a=a.Hb(),a=UEa(a,mx(a))):a=null;return a}function fGc(a){return(a=gGc(a))?a.clone():null}
r.Yba=function(a){var b=gGc(this);if(("Ea"==a.type||"P"==a.type)&&!b&&this.B&&(a=this.o.j.getActiveGrid())&&(a=a.Hb(),a.lb()==this.B.Zl())){var c=ow(this.B,a);c&&(rx(a,c),b=gGc(this))}b&&!b.equals(this.B,this.o)&&this.j.pe(b);this.B=b;this.Pf().setVisible(!!b&&!wF(this.o))};r.Skb=function(a){a=a.target;if(this.B&&this.B.Zl()==a.$a()&&this.j.Va()){a=this.j;var b=RBa(a.Za);b&&a.F&&b.setVisible(!1)}};
r.Vkb=function(a){var b=a.target;if(nn(b,tXb.Jfa)||nn(b,tXb.Ifa)){var b=Sv(this.J).getModel(),c=ex(b,a.qf);mGc(this,b,c);a.stopPropagation()}};r.Wkb=function(a){var b=Sv(this.J).getModel();a=ex(b,a.qf);mGc(this,b,a)};
function mGc(a,b,c){if(!wF(a.o)){var d=c.bj();b=UEa(b,c);if(c=d.OM()){var e=c.length-1;c=c[e];for(var d="r"==d.$B()?b.Nn()[e]:b.Hn()[e],e=eg(d,7),f,h=0;h<e.length;h++)if(e[h].getValue()==c){f=e[h];var k=!G(f,3);I(f,3,k)}f||(f=new lg,f.Ra(c),I(f,3,!0),bg(d,7,f));Mo(G(f,3)?"Pivot table field collapsed":"Pivot table field expanded");I$(a,b,!0)}}}function lGc(a,b){cg(a,3);I(a,5,!1);B(b,function(b){bg(a,3,b)})}r.R=function(){dGc.K.R.call(this)};function nGc(){J.call(this)}A(nGc,yo);nGc.prototype.o=function(){return C$};nGc.prototype.j=function(){return dGc};Go("pivottables",nGc);
